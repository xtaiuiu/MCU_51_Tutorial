C51 COMPILER V9.57.0.0   MAIN                                                              01/27/2026 11:34:57 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: d:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /**********************************************************************************
   2          ****
   3          实验名称：串口通信实验
   4          接线说明：
   5          实验现象：下载程序后，当串口助手发送数据给单片机，单片机原封不动转发给串口助手显示
   6          注意事项：使用黄色跳线帽将CH340 旁的P5 端子的UTX 和P30 短接，URX 和P31 短接，出厂默
   7          认已短接好
   8          ***********************************************************************************
   9          ****/
  10          #include "reg52.h"
  11          typedef unsigned int u16;//对系统默认数据类型进行重定义
  12          typedef unsigned char u8;
  13          /*******************************************************************************
  14          * 函数名: uart_init
  15          * 函数功能: 串口通信中断配置函数，通过设置TH 和TL 即可确定定时时间
  16          * 输入: baud：波特率对应的TH、TL 装载值
  17          * 输出: 无
  18          *******************************************************************************/
  19          void uart_init(u8 baud)
  20          {
  21   1              TMOD|=0X20; //设置计数器工作方式2
  22   1              SCON=0X50; //设置为工作方式1
  23   1              PCON=0X80; //波特率加倍
  24   1              TH1=baud; //计数器初始值设置
  25   1              TL1=baud;
  26   1              ES=1; //打开接收中断
  27   1              EA=1; //打开总中断
  28   1              TR1=1; //打开计数器
  29   1      }
  30          /*******************************************************************************
  31          * 函数名: main
  32          * 函数功能: 主函数
  33          * 输入: 无
  34          * 输出: 无
  35          *******************************************************************************/
  36          void main()
  37          {
  38   1              uart_init(0XFA);//波特率为9600
  39   1      while(1)
  40   1              {
  41   2              }
  42   1      }
  43          void uart() interrupt 4 //串口通信中断函数
  44          {
  45   1              u8 rec_data;
  46   1              RI = 0; //清除接收中断标志位
  47   1              rec_data=SBUF; //存储接收到的数据
  48   1              SBUF=rec_data; //将接收到的数据放入到发送寄存器
  49   1              while(!TI); //等待发送数据完成
  50   1              TI=0; //清除发送完成标志位
  51   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.57.0.0   MAIN                                                              01/27/2026 11:34:57 PAGE 2   

   CODE SIZE        =     50    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
